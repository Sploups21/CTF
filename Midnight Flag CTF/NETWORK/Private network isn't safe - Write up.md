# Private network isn't safe - Write up

For this challenge, a file named <em>capture.pcapng</em>. The goal is to find the hidden data.

Let's Wireshark it :

![1](https://user-images.githubusercontent.com/66923124/164991012-0329dc63-f378-487b-aba9-7793165b65bb.png)

I begin by listing the HTTP objects :

![1](https://user-images.githubusercontent.com/66923124/164991290-c99d76ee-6b6e-4626-b3a1-1ec908072ad7.png)

A zip file... let's extract it from the capture and try to unzip it :

![1](https://user-images.githubusercontent.com/66923124/164991810-bab6fe32-5824-4ce1-88dc-4b9ae7ce59f7.png)
![1](https://user-images.githubusercontent.com/66923124/164991893-9a457051-15ba-415e-b913-2f2251cdd40d.png)
![1](https://user-images.githubusercontent.com/66923124/164991941-26679428-661f-4b93-8f92-e3a781d4548c.png)

Of course, a password is required 🙃 Let's dig a little more into this capture then... <br><br>

The interesting data is apparently in the ICMP packets, since they compose 95% of the capture so I apply a filter to keep only those :

![1](https://user-images.githubusercontent.com/66923124/164991357-d55d8f52-bf06-4f67-85ae-c3d1f8b225b7.png)

A message can be read in the data of the ICMP packets while scrolling down in the capture :

![a](https://user-images.githubusercontent.com/66923124/164991652-6162ff94-7b94-4b0c-a689-8b9ed365cf65.PNG)
![b](https://user-images.githubusercontent.com/66923124/164991655-0c3c058e-47ca-4f0a-8d42-7aa29a85d7ae.PNG)
![s](https://user-images.githubusercontent.com/66923124/164991709-ce96506e-cebb-4f18-8859-49e9c1474fe3.PNG)
![c](https://user-images.githubusercontent.com/66923124/164991657-b8493828-4f7b-4b5f-8d00-af1476e12e34.PNG)
![d](https://user-images.githubusercontent.com/66923124/164991658-0e15bf80-6397-43d4-9e01-2b2c3d580d08.PNG)
![e](https://user-images.githubusercontent.com/66923124/164991659-8130d410-9678-43d2-936a-4d418d3c7195.PNG)
![f](https://user-images.githubusercontent.com/66923124/164991661-85575c4d-a860-4ac2-812d-bb426974c092.PNG)
![g](https://user-images.githubusercontent.com/66923124/164991663-f17b1f43-462b-4d90-aab0-66c24ef9810d.PNG)
![h](https://user-images.githubusercontent.com/66923124/164991665-d95122c7-98ef-455b-b613-e50040ad34c5.PNG)
![i](https://user-images.githubusercontent.com/66923124/164991666-e2fac580-d747-4788-bc5f-3d824cf9df04.PNG)
![j](https://user-images.githubusercontent.com/66923124/164991669-94b32719-de34-46f8-8d48-7b1e5f3ef408.PNG)
![k](https://user-images.githubusercontent.com/66923124/164991670-10b63cc1-6d75-4e25-8040-25a68657da92.PNG)

```
Hello Are You Looking For A Password ? Here It Is :
```
Just after this sentence, we have a packet stream that contains hexadecimal data, starting at the packet 219 :

![1](https://user-images.githubusercontent.com/66923124/164992378-4abb828a-f538-483c-9de5-b3e465e2212c.png)

and that continues till the packet 418 :

![1](https://user-images.githubusercontent.com/66923124/164992414-d96ffdd1-932d-495e-a15a-34b4288e1bcc.png)

🡆 <strong> So let's dump all the packets between 219 and 418 and perform an Hex to ASCII conversion to retrieve the password !</strong>
<br>

To do that, I select all the packets between 218 and 418 and create a new PCAP with only these packets :

![1](https://user-images.githubusercontent.com/66923124/164992627-4d5e7943-6aca-4789-b1f5-a865c408c645.png)
![1](https://user-images.githubusercontent.com/66923124/164992691-09af4736-85e4-416f-b7be-aecd6bc4b391.png)

And I run the following script to extract all the content of the ICMP packets of my new pcap into a file named output.txt :

```
#icmp_dump.py

from scapy.all import *

capture = rdpcap('icmp_packets.pcap')
ping_data = ""

for packet in capture:
   if packet[ICMP].type == 8: # Echo request
       ping_data += packet.load + "\n"

print ping_data
```
> I found this script on https://www.boiteaklou.fr/Data-exfiltration-with-PING-ICMP-NDH16.html and I modified it a little bit to fit my needs 😊

![1](https://user-images.githubusercontent.com/66923124/164992866-b835b19a-1bbe-4936-9844-0880037445eb.png)


Here is the content of output.txt :

```
®Ób    SÊ     703473735730300a703473735730300a70347373
®Ób    íÍ     703473735730310a703473735730310a70347373
®Ób    •Ñ     703473735730320a703473735730320a70347373
®Ób    ZÕ     703473735730330a703473735730330a70347373
®Ób    ôØ     703473735730340a703473735730340a70347373
®Ób    ¬Ü     703473735730350a703473735730350a70347373
®Ób    "à     703473735730360a703473735730360a70347373
®Ób    Èä     703473735730370a703473735730370a70347373
®Ób    é     703473735730380a703473735730380a70347373
®Ób    }í     703473735730390a703473735730390a70347373
®Ób    Aø     703473735731300a703473735731300a70347373
®Ób    \ý     703473735731310a703473735731310a70347373
®Ób    x     703473735731320a703473735731320a70347373
®Ób    »     703473735731330a703473735731330a70347373
®Ób    Z
     703473735731340a703473735731340a70347373
®Ób    â
     703473735731350a703473735731350a70347373
®Ób    n     703473735731360a703473735731360a70347373
®Ób    C     703473735731370a703473735731370a70347373
®Ób         703473735731380a703473735731380a70347373
®Ób    ³     703473735731390a703473735731390a70347373
®Ób    _$     703473735732300a703473735732300a70347373
®Ób    Ö*     703473735732310a703473735732310a70347373
®Ób    E0     703473735732320a703473735732320a70347373
®Ób    ¶4     703473735732330a703473735732330a70347373
®Ób    9     703473735732340a703473735732340a70347373
®Ób    ë>     703473735732350a703473735732350a70347373
®Ób    $D     703473735732360a703473735732360a70347373
®Ób    sP     703473735732370a703473735732370a70347373
®Ób    ÈW     703473735732380a703473735732380a70347373
®Ób    âv     703473735732390a703473735732390a70347373
®Ób    1~     703473735733300a703473735733300a70347373
®Ób    |…     703473735733310a703473735733310a70347373
®Ób    ‹     703473735733320a703473735733320a70347373
®Ób    B     703473735733330a703473735733330a70347373
®Ób    ò’     703473735733340a703473735733340a70347373
®Ób    €–     703473735733350a703473735733350a70347373
®Ób    ð™     703473735733360a703473735733360a70347373
®Ób    Š     703473735733370a703473735733370a70347373
®Ób    Q¡     703473735733380a703473735733380a70347373
®Ób    Ð¥     703473735733390a703473735733390a70347373
®Ób    î³     703473735734300a703473735734300a70347373
®Ób    ¹     703473735734310a703473735734310a70347373
®Ób    À¼     703473735734320a703473735734320a70347373
®Ób    ŸÀ     703473735734330a703473735734330a70347373
®Ób    AÄ     703473735734340a703473735734340a70347373
®Ób    
Ë     703473735734350a703473735734350a70347373
®Ób    ¥Ý     703473735734360a703473735734360a70347373
®Ób    ñä     703473735734370a703473735734370a70347373
®Ób    é     703473735734380a703473735734380a70347373
®Ób    Éì     703473735734390a703473735734390a70347373
®Ób    ‚ñ     703473735735300a703473735735300a70347373
®Ób    ³õ     703473735735310a703473735735310a70347373
®Ób    4ù     703473735735320a703473735735320a70347373
®Ób    ¤ü     703473735735330a703473735735330a70347373
®Ób    Â      703473735735340a703473735735340a70347373
®Ób    7     703473735735350a703473735735350a70347373
®Ób    
     703473735735360a703473735735360a70347373
®Ób    O     703473735735370a703473735735370a70347373
®Ób    ô     703473735735380a703473735735380a70347373
®Ób    œ     703473735735390a703473735735390a70347373
®Ób         703473735736300a703473735736300a70347373
®Ób    h     703473735736310a703473735736310a70347373
®Ób    &     703473735736320a703473735736320a70347373
®Ób    ‡9     703473735736330a703473735736330a70347373
®Ób    KA     703473735736340a703473735736340a70347373
®Ób    ¤H     703473735736350a703473735736350a70347373
®Ób    ûL     703473735736360a703473735736360a70347373
®Ób    P     703473735736370a703473735736370a70347373
®Ób    ûS     703473735736380a703473735736380a70347373
®Ób    jW     703473735736390a703473735736390a70347373
®Ób    àZ     703473735737300a703473735737300a70347373
®Ób    <_     703473735737310a703473735737310a70347373
®Ób    \d     703473735737320a703473735737320a70347373
®Ób    £h     703473735737330a703473735737330a70347373
®Ób    n     703473735737340a703473735737340a70347373
®Ób    Rr     703473735737350a703473735737350a70347373
®Ób    Ýu     703473735737360a703473735737360a70347373
®Ób    {y     703473735737370a703473735737370a70347373
®Ób    }     703473735737380a703473735737380a70347373
®Ób    ¦€     703473735737390a703473735737390a70347373
®Ób    4„     703473735738300a703473735738300a70347373
®Ób    ¹‡     703473735738310a703473735738310a70347373
®Ób    rŒ     703473735738320a703473735738320a70347373
®Ób    *     703473735738330a703473735738330a70347373
®Ób    á”     703473735738340a703473735738340a70347373
®Ób    ¡œ     703473735738350a703473735738350a70347373
®Ób    ¢     703473735738360a703473735738360a70347373
®Ób    v¦     703473735738370a703473735738370a70347373
®Ób    vª     703473735738380a703473735738380a70347373
®Ób    )¯     703473735738390a703473735738390a70347373
®Ób    À     703473735739300a703473735739300a70347373
®Ób    É     703473735739310a703473735739310a70347373
®Ób    ÎÏ     703473735739320a703473735739320a70347373
®Ób    ©Ó     703473735739330a703473735739330a70347373
®Ób    %×     703473735739340a703473735739340a70347373
®Ób    ,Û     703473735739350a703473735739350a70347373
®Ób    ´Þ     703473735739360a703473735739360a70347373
®Ób    ^â     703473735739370a703473735739370a70347373
®Ób    #æ     703473735739380a703473735739380a70347373
®Ób    ê     703473735739390a703473735739390a70347373

```

Now let's remove all the garbage of the file to keep only the valid hex strings :

```
703473735730300a703473735730300a70347373
703473735730310a703473735730310a70347373
703473735730320a703473735730320a70347373
703473735730330a703473735730330a70347373
703473735730340a703473735730340a70347373
703473735730350a703473735730350a70347373
703473735730360a703473735730360a70347373
703473735730370a703473735730370a70347373
703473735730380a703473735730380a70347373
703473735730390a703473735730390a70347373
703473735731300a703473735731300a70347373
703473735731310a703473735731310a70347373
703473735731320a703473735731320a70347373
703473735731330a703473735731330a70347373
703473735731340a703473735731340a70347373
703473735731350a703473735731350a70347373
703473735731360a703473735731360a70347373
703473735731370a703473735731370a70347373
703473735731380a703473735731380a70347373
703473735731390a703473735731390a70347373
703473735732300a703473735732300a70347373
703473735732310a703473735732310a70347373
703473735732320a703473735732320a70347373
703473735732330a703473735732330a70347373
703473735732340a703473735732340a70347373
703473735732350a703473735732350a70347373
703473735732360a703473735732360a70347373
703473735732370a703473735732370a70347373
703473735732380a703473735732380a70347373
703473735732390a703473735732390a70347373
703473735733300a703473735733300a70347373
703473735733310a703473735733310a70347373
703473735733320a703473735733320a70347373
703473735733330a703473735733330a70347373
703473735733340a703473735733340a70347373
703473735733350a703473735733350a70347373
703473735733360a703473735733360a70347373
703473735733370a703473735733370a70347373
703473735733380a703473735733380a70347373
703473735733390a703473735733390a70347373
703473735734300a703473735734300a70347373
703473735734310a703473735734310a70347373
703473735734320a703473735734320a70347373
703473735734330a703473735734330a70347373
703473735734340a703473735734340a70347373
703473735734350a703473735734350a70347373
703473735734360a703473735734360a70347373
703473735734370a703473735734370a70347373
703473735734380a703473735734380a70347373
703473735734390a703473735734390a70347373
703473735735300a703473735735300a70347373
703473735735310a703473735735310a70347373
703473735735320a703473735735320a70347373
703473735735330a703473735735330a70347373
703473735735340a703473735735340a70347373
703473735735350a703473735735350a70347373
703473735735360a703473735735360a70347373
703473735735370a703473735735370a70347373
703473735735380a703473735735380a70347373
703473735735390a703473735735390a70347373
703473735736300a703473735736300a70347373
703473735736310a703473735736310a70347373
703473735736320a703473735736320a70347373
703473735736330a703473735736330a70347373
703473735736340a703473735736340a70347373
703473735736350a703473735736350a70347373
703473735736360a703473735736360a70347373
703473735736370a703473735736370a70347373
703473735736380a703473735736380a70347373
703473735736390a703473735736390a70347373
703473735737300a703473735737300a70347373
703473735737310a703473735737310a70347373
703473735737320a703473735737320a70347373
703473735737330a703473735737330a70347373
703473735737340a703473735737340a70347373
703473735737350a703473735737350a70347373
703473735737360a703473735737360a70347373
703473735737370a703473735737370a70347373
703473735737380a703473735737380a70347373
703473735737390a703473735737390a70347373
703473735738300a703473735738300a70347373
703473735738310a703473735738310a70347373
703473735738320a703473735738320a70347373
703473735738330a703473735738330a70347373
703473735738340a703473735738340a70347373
703473735738350a703473735738350a70347373
703473735738360a703473735738360a70347373
703473735738370a703473735738370a70347373
703473735738380a703473735738380a70347373
703473735738390a703473735738390a70347373
703473735739300a703473735739300a70347373
703473735739310a703473735739310a70347373
703473735739320a703473735739320a70347373
703473735739330a703473735739330a70347373
703473735739340a703473735739340a70347373
703473735739350a703473735739350a70347373
703473735739360a703473735739360a70347373
703473735739370a703473735739370a70347373
703473735739380a703473735739380a70347373
703473735739390a703473735739390a70347373

```

Perfect ! I put the content of the hex stream inside a file and use <strong>xxd</strong> to decode it.<br> When I <strong>head</strong> the decoded file, it seems like we have a wordlist : 

![1](https://user-images.githubusercontent.com/66923124/164993077-3aec2754-87ae-4754-aaee-72b32b4f2604.png)

The last step is to use this wordlist to crack the zip file from the beginning :

![1](https://user-images.githubusercontent.com/66923124/164993314-3f2a679e-b321-491b-b52f-3a1cb76cb466.png)

🡆 <strong> password of the archive : p4ssW77 </strong>

And to see the flag 😊

![1](https://user-images.githubusercontent.com/66923124/164993419-ed7a06e8-b93c-4672-8ac5-14e87d258795.png)


<strong> FLAG : MCTF{p4ck37_an4LyZ3r} </strong>

